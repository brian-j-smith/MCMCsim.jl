.. index:: Examples; Pollution: Bayesian Variable Selection

.. _example-Pollution:

Pollution: Bayesian Variable Selection
--------------------------------------

Data are from McDonald and Schwing :cite:`mcdonal:1973:pol`. The data includes 15 independent variables and a measure of mortality on 60 US metropolitan areas in 1959-1961. Originally the data were used to illustrate ridge regression (the full X matrix has a huge condition number). 

Model
^^^^^
.. math::

    y_{i} &\sim \text{Normal}(\mu_i, \sigma) \quad\quad i=1, \ldots, 60 \\
    \mu_i &= \alpha + \sum_{j=1}^p \theta_j x_{ij} \quad\quad i=1, \ldots, 60; j = 1, \ldots, 15\\
    \theta_j &= \beta_j\gamma_j\\
    \alpha &\sim \text{Normal}(\mu_\alpha, \sigma_\alpha)\\
    \beta_j|\gamma_j=1 &\sim \text{Normal}(\mu_\beta, \sigma_\beta)\\
    \beta_j|\gamma_j=0 &\sim \text{Normal}(0, 10^12)\\
    \gamma_j &\sim \text{Bernoulli}(0.5)\\
    \mu_\alpha, \mu_\beta &\sim \text{Normal}(0,1000)\\
    \sigma_\alpha^2, \sigma_\beta^2, \sigma^2 &\sim \text{InverseGamma}(0.0001,0.0001)\\


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: pollution.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    
    Iterations = 1001:10000
    Thinning interval = 1
    Chains = 1,2,3,4
    Samples per chain = 9000
    
    Empirical Posterior Estimates:
                  Mean           SD          Naive SE          MCSE          ESS   
      beta[1]   15.4067833    9.490938579 0.050021638402  0.494333030529  368.62014
      beta[2]  -19.2853462   14.603678921 0.076968146013  0.766555699157  362.94191
      beta[3]   10.9576918   10.268497835 0.054119735510  0.536882020918  365.81045
      beta[4]    7.0352589    9.269855670 0.048856429162  0.482706583842  368.79031
      beta[5]   13.2074495    6.538960255 0.034463346557  0.339269291644  371.47389
      beta[6]    0.8842630   14.047476514 0.074036701934  0.737416712438  362.88639
      beta[7]    9.5069898   10.279409334 0.054177244161  0.537282415292  366.04212
      beta[8]    9.6222231    6.079104662 0.032039694779  0.311158849475  381.69364
      beta[9]   26.1411730   11.195762255 0.059006848113  0.585298060731  365.89221
     beta[10]   -0.8382551   13.942133453 0.073481495254  0.731676662668  363.09483
     beta[11]   13.6909446   15.635013753 0.082403757848  0.821242970529  362.45426
     beta[12]   -8.0655636    7.895416010 0.041612496112  0.408726758186  373.15039
     beta[13]   10.9054197   10.345735234 0.054526812350  0.540003651182  367.05346
     beta[14]   21.0503643    7.754855461 0.040871676969  0.401540456438  372.98279
     beta[15]   11.1498066    7.069624268 0.037260191479  0.364923703496  375.30860
        sigma 2041.8712322 1375.738374715 7.250777880997 72.602613903454  359.06013
     theta[1]   15.4067833    9.490938579 0.050021638402  0.494333030529  368.62014
     theta[2]  -19.2853462   14.603678921 0.076968146013  0.766555699157  362.94191
     theta[3]   10.9576918   10.268497835 0.054119735510  0.536882020918  365.81045
     theta[4]    7.0352589    9.269855670 0.048856429162  0.482706583842  368.79031
     theta[5]   13.2074495    6.538960255 0.034463346557  0.339269291644  371.47389
     theta[6]    0.8842630   14.047476514 0.074036701934  0.737416712438  362.88639
     theta[7]    9.5069898   10.279409334 0.054177244161  0.537282415292  366.04212
     theta[8]    9.6222231    6.079104662 0.032039694779  0.311158849475  381.69364
     theta[9]   26.1411730   11.195762255 0.059006848113  0.585298060731  365.89221
    theta[10]   -0.8382551   13.942133453 0.073481495254  0.731676662668  363.09483
    theta[11]   13.6909446   15.635013753 0.082403757848  0.821242970529  362.45426
    theta[12]   -8.0655636    7.895416010 0.041612496112  0.408726758186  373.15039
    theta[13]   10.9054197   10.345735234 0.054526812350  0.540003651182  367.05346
    theta[14]   21.0503643    7.754855461 0.040871676969  0.401540456438  372.98279
    theta[15]   11.1498066    7.069624268 0.037260191479  0.364923703496  375.30860
        alpha   14.4077819   23.461996530 0.123655579147  1.233936098107  361.53021
     gamma[1]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[2]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[3]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[4]    0.9999722    0.005270463 0.000027777778  0.000027777778 9000.00000
     gamma[5]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[6]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[7]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[8]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
     gamma[9]    0.9997500    0.015809631 0.000083324073  0.000202076423 6120.85643
    gamma[10]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
    gamma[11]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
    gamma[12]    0.9999722    0.005270463 0.000027777778  0.000027777778 9000.00000
    gamma[13]    0.9999722    0.005270463 0.000027777778  0.000027777778 9000.00000
    gamma[14]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
    gamma[15]    1.0000000    0.000000000 0.000000000000  0.000000000000 9000.00000
    
    Quantiles:
                  2.5%         25.0%         50.0%         75.0%       97.5%   
      beta[1]  -2.90029077    9.73577923   14.68445853   20.8214660   33.914166
      beta[2] -53.45812176  -27.21122948  -18.17880532   -9.0861374    4.297384
      beta[3]  -3.66739557    2.92027253    8.05112513   18.4218921   31.766450
      beta[4]  -9.55971049   -1.14101820    8.34644190   14.8479808   21.908113
      beta[5]  -0.88505938    9.03377974   13.62231665   17.9452369   24.342774
      beta[6] -21.80617148  -10.46476455   -0.60954314   10.9803203   29.244957
      beta[7] -12.34773935    3.41573304   10.08166505   17.7343439   26.185954
      beta[8]  -0.92210853    5.23731115    9.12515159   13.5164213   22.979156
      beta[9]   4.63605204   17.66538779   27.00114824   35.2477935   45.456859
     beta[10] -28.17536180   -8.57635798   -1.62991624    9.7511800   24.956300
     beta[11] -11.02892712    2.11126424   10.62344281   23.7903419   47.200574
     beta[12] -24.10450209  -12.80469777   -7.84240330   -3.3330360    8.115268
     beta[13] -10.79358450    5.07090426   11.94902493   17.7155485   29.104648
     beta[14]   9.07407353   15.84492725   19.41790312   24.7911484   40.626336
     beta[15]  -3.42517083    6.29218163   11.74951802   16.4343422   23.148143
        sigma 950.34700983 1162.00927093 1324.61670638 2322.8684895 4630.639504
     theta[1]  -2.90029077    9.73577923   14.68445853   20.8214660   33.914166
     theta[2] -53.45812176  -27.21122948  -18.17880532   -9.0861374    4.297384
     theta[3]  -3.66739557    2.92027253    8.05112513   18.4218921   31.766450
     theta[4]  -9.55971049   -1.14101820    8.34644190   14.8479808   21.908113
     theta[5]  -0.88505938    9.03377974   13.62231665   17.9452369   24.342774
     theta[6] -21.80617148  -10.46476455   -0.60954314   10.9803203   29.244957
     theta[7] -12.34773935    3.41573304   10.08166505   17.7343439   26.185954
     theta[8]  -0.92210853    5.23731115    9.12515159   13.5164213   22.979156
     theta[9]   4.63605204   17.66538779   27.00114824   35.2477935   45.456859
    theta[10] -28.17536180   -8.57635798   -1.62991624    9.7511800   24.956300
    theta[11] -11.02892712    2.11126424   10.62344281   23.7903419   47.200574
    theta[12] -24.10450209  -12.80469777   -7.84240330   -3.3330360    8.115268
    theta[13] -10.79358450    5.07090426   11.94902493   17.7155485   29.104648
    theta[14]   9.07407353   15.84492725   19.41790312   24.7911484   40.626336
    theta[15]  -3.42517083    6.29218163   11.74951802   16.4343422   23.148143
        alpha -32.56273559   -0.03785126   12.77837605   30.4538209   60.069413
     gamma[1]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[2]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[3]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[4]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[5]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[6]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[7]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[8]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
     gamma[9]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
    gamma[10]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
    gamma[11]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
    gamma[12]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
    gamma[13]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
    gamma[14]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
    gamma[15]   1.00000000    1.00000000    1.00000000    1.0000000    1.000000
        
