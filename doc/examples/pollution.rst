.. index:: Examples; Pollution: Bayesian Variable Selection

.. _example-Pollution:

Pollution: Bayesian Variable Selection
--------------------------------------

Data from McDonald and Schwing :cite:`mcdonald:1973:pol` that include 15 independent variables and a measure of mortality on 60 U.S. metropolitan areas in 1959-1961. Originally, the data were used to illustrate ridge regression (the full covariate matrix has a huge condition number). This dataset was included in a review of Bayesian variable selection techniques by O'Hara et al :cite:`ohara:2009:BVS`. 

Model
^^^^^

.. math::

    y_{i} &\sim \text{Normal}(\mu_i, \sigma) \quad\quad i=1, \ldots, 60 \\
    \mu_i &= \alpha + \sum_{j=1}^{15} \theta_j x_{ij} \\
    \theta_j &= \beta_j \gamma_j \\
    \alpha, \beta_j &\sim \text{Normal}(0, 1000) \\
    \gamma_j &\sim \text{Bernoulli}(0.5) \\
    \sigma^2 &\sim \text{InverseGamma}(0.0001, 0.0001) \\


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: pollution.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    ## Binary Hamiltonian Monte Carlo

    Iterations = 1002:10000
    Thinning interval = 2
    Chains = 1,2,3,4
    Samples per chain = 4500

    Empirical Posterior Estimates:
                    Mean           SD        Naive SE        MCSE         ESS
     gamma[1]    0.4133333333   0.49244529 0.0036704705  0.0344126924  204.77582
     gamma[2]    0.6201111111   0.48537244 0.0036177526  0.0339688934  204.16789
     gamma[3]    0.0216666667   0.14559670 0.0010852138  0.0077337363  354.42501
     gamma[4]    0.1692777778   0.37500750 0.0027951409  0.0242726637  238.69594
     gamma[5]    0.0069444444   0.08304578 0.0006189867  0.0032062335  670.88007
     gamma[6]    0.3133888889   0.46388387 0.0034575862  0.0335487605  191.19018
     gamma[7]    0.0081111111   0.08969820 0.0006685709  0.0031991511  786.13656
     gamma[8]    0.0403888889   0.19687504 0.0014674199  0.0089478675  484.10795
     gamma[9]    0.9639444444   0.18643359 0.0013895939  0.0114981167  262.90261
    gamma[10]    0.0292222222   0.16843355 0.0012554295  0.0094249479  319.37379
    gamma[11]    0.0283333333   0.16592795 0.0012367539  0.0071632988  536.55343
    gamma[12]    0.0779444444   0.26809159 0.0019982367  0.0176148704  231.63676
    gamma[13]    0.0852777778   0.27930237 0.0020817969  0.0179203408  242.91633
    gamma[14]    0.4846666667   0.49977872 0.0037251306  0.0331207748  227.69555
    gamma[15]    0.0076666667   0.08722564 0.0006501415  0.0026060380 1120.28059
     theta[1]    8.8994242736  11.59008008 0.0863873564  0.7747882403  223.77256
     theta[2]  -12.4581866783  10.95706716 0.0816691567  0.6983997929  246.13901
     theta[3]   -0.2189132408   1.84700527 0.0137667645  0.0847541713  474.91305
     theta[4]    3.1939974915   7.83992610 0.0584353590  0.4814944964  265.11926
     theta[5]   -0.0278718638   0.99726572 0.0074331798  0.0345409247  833.59262
     theta[6]   -6.3986040706  10.19312226 0.0759750476  0.6984250067  212.99770
     theta[7]   -0.0480763996   1.00275282 0.0074740782  0.0313706611 1021.74010
     theta[8]    0.4908662038   2.63767598 0.0196600760  0.1145365076  530.34077
     theta[9]   40.3087457262  13.92326872 0.1037779178  0.8524282500  266.78828
    theta[10]   -0.3366587925   2.25893863 0.0168371344  0.1235290510  334.40338
    theta[11]   -0.3401516475   3.03624696 0.0226308486  0.1368506237  492.24422
    theta[12]   -9.2881602728  36.05648390 0.2687491635  2.5016971815  207.72907
    theta[13]    8.6819083942  34.40091135 0.2564092542  2.3633812756  211.87139
    theta[14]   10.3066054636  11.53554898 0.0859809056  0.7477611268  237.98565
    theta[15]    0.0347354176   0.60466320 0.0045068934  0.0144774903 1744.37766
       sigma2 1617.5295197612 445.68394063 3.3219319591 24.1076380357  341.77843
        alpha  957.5039344474 177.73354999 1.3247476655 11.7408022904  229.16236

    Quantiles:
                  2.5%       25.0%       50.0%       75.0%       97.5%
     gamma[1]    0.000000    0.000000    0.000000    1.000000    1.000000
     gamma[2]    0.000000    0.000000    1.000000    1.000000    1.000000
     gamma[3]    0.000000    0.000000    0.000000    0.000000    0.000000
     gamma[4]    0.000000    0.000000    0.000000    0.000000    1.000000
     gamma[5]    0.000000    0.000000    0.000000    0.000000    0.000000
     gamma[6]    0.000000    0.000000    0.000000    1.000000    1.000000
     gamma[7]    0.000000    0.000000    0.000000    0.000000    0.000000
     gamma[8]    0.000000    0.000000    0.000000    0.000000    1.000000
     gamma[9]    0.000000    1.000000    1.000000    1.000000    1.000000
    gamma[10]    0.000000    0.000000    0.000000    0.000000    1.000000
    gamma[11]    0.000000    0.000000    0.000000    0.000000    1.000000
    gamma[12]    0.000000    0.000000    0.000000    0.000000    1.000000
    gamma[13]    0.000000    0.000000    0.000000    0.000000    1.000000
    gamma[14]    0.000000    0.000000    0.000000    1.000000    1.000000
    gamma[15]    0.000000    0.000000    0.000000    0.000000    0.000000
     theta[1]    0.000000    0.000000    0.000000   19.411243   33.367468
     theta[2]  -31.599981  -21.351962  -14.644122    0.000000    0.000000
     theta[3]    0.000000    0.000000    0.000000    0.000000    0.000000
     theta[4]    0.000000    0.000000    0.000000    0.000000   27.399450
     theta[5]    0.000000    0.000000    0.000000    0.000000    0.000000
     theta[6]  -29.814377  -15.033324    0.000000    0.000000    0.000000
     theta[7]    0.000000    0.000000    0.000000    0.000000    0.000000
     theta[8]    0.000000    0.000000    0.000000    0.000000   10.318096
     theta[9]    0.000000   32.563104   39.851191   48.801988   67.192876
    theta[10]   -4.947355    0.000000    0.000000    0.000000    0.000000
    theta[11]    0.000000    0.000000    0.000000    0.000000    0.000000
    theta[12] -152.866327    0.000000    0.000000    0.000000    0.000000
    theta[13]    0.000000    0.000000    0.000000    0.000000  145.131614
    theta[14]    0.000000    0.000000    0.000000   20.914455   32.081848
    theta[15]    0.000000    0.000000    0.000000    0.000000    0.000000
       sigma2  989.986951 1304.991893 1539.492872 1833.601223 2800.287033
        alpha  720.109637  836.274820  889.062699 1096.490010 1332.561790
